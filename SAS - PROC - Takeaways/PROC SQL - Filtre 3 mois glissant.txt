proc sql noprint;
Create table 
	STATS.DATA_LOGS_TRI_WAVELABS AS SELECT
        WAFER_WAV.IdRecord length=8 format=11. AS IdRecord,
        WAFER_WAV.IdEquipement length=8 format=11. AS IdEquipement,
        WAFER_WAV.RunID length=255 format=$255. AS RunID,
        WAFER_WAV.TimeStamp_Flash length=8 format=DATETIME22.3 AS TimeStamp_Flash,
        WAFER_WAV.TimeStamp_Flash_utc length=8 format=DATETIME22.3 AS TimeStamp_Flash_utc,
        WAFER_WAV.LotId length=9 format=$9. AS LotId,
        WAFER_WAV.WaferEqID length=2 format=$2. AS WaferEqID,
        WAFER_WAV.WaferNr length=5 format=$5. AS WaferNr,
        WAFER_WAV.WaferID_Manu length=255 format=$255. AS WaferID_Manu,
        WAFER_WAV.WaferID_Auto length=255 format=$255. AS WaferID_Auto,
        WAFER_WAV.Comment length=255 format=$255. AS Comment,
        WAFER_WAV.RecipeName length=255 format=$255. AS RecipeName,
        WAFER_WAV.RecipeHash length=255 format=$255. AS RecipeHash,
        WAFER_WAV.RecipeActivationTime length=8 format=DATETIME22.3 AS RecipeActivationTime,
        WAFER_WAV.RecipeActivationTime_utc length=8 format=DATETIME22.3 AS RecipeActivationTime_utc,
        WAFER_WAV.StepNum length=8 format=11. AS StepNum,
        WAFER_WAV.StepName length=255 format=$255. AS StepName,
        WAFER_WAV.Class length=255 format=$255. AS Class,
        WAFER_WAV.Bin length=8 format=11. AS Bin,
        WAFER_WAV.MatchingClassifierLine length=8 format=11. AS MatchingClassifierLine,
        WAFER_WAV.Voc length=8 AS Voc,
        WAFER_WAV.Isc length=8 AS Isc,
        WAFER_WAV.Pmpp length=8 AS Pmpp,
        WAFER_WAV.FF length=8 AS FF,
        WAFER_WAV.Eta length=8 AS Eta,
        WAFER_WAV.Rs length=8 AS Rs,
        WAFER_WAV.Rp length=8 AS Rp,
        WAFER_WAV.Vmpp length=8 AS Vmpp,
        WAFER_WAV.Impp length=8 AS Impp,
        WAFER_WAV.Iat_Vlight1 length=8 AS Iat_Vlight1,
        WAFER_WAV.Iat_Vlight2 length=8 AS Iat_Vlight2,
        WAFER_WAV.Iat_Vlight3 length=8 AS Iat_Vlight3,
        WAFER_WAV.Idk_6 length=8 AS Idk_6,
        WAFER_WAV.Idk_10 length=8 AS Idk_10,
        WAFER_WAV.Idk_12 length=8 AS Idk_12,
        WAFER_WAV.Idk_13 length=8 AS Idk_13,
        WAFER_WAV.Idk_Vmin length=8 AS Idk_Vmin,
        WAFER_WAV.Idk_Imax length=8 AS Idk_Imax,
        WAFER_WAV.Iat_Vdark1 length=8 AS Iat_Vdark1,
        WAFER_WAV.Iat_Vdark2 length=8 AS Iat_Vdark2,
        WAFER_WAV.Iat_Vdark3 length=8 AS Iat_Vdark3,
        WAFER_WAV.pVoc length=8 AS pVoc,
        WAFER_WAV.pIsc length=8 AS pIsc,
        WAFER_WAV.pFF length=8 AS pFF,
        WAFER_WAV.pEta length=8 AS pEta,
        WAFER_WAV.pImpp length=8 AS pImpp,
        WAFER_WAV.pVmpp length=8 AS pVmpp,
        WAFER_WAV.EL_AvgVoltage length=8 AS EL_AvgVoltage,
        WAFER_WAV.EL_AvgCurrent length=8 AS EL_AvgCurrent,
        WAFER_WAV.EL_EnergyInput length=8 AS EL_EnergyInput,
        WAFER_WAV.EL_DefectArea length=8 format=11. AS EL_DefectArea,
        WAFER_WAV.EL_CountCracks length=8 format=11. AS EL_CountCracks,
        WAFER_WAV.EL_CountScratches length=8 format=11. AS EL_CountScratches,
        WAFER_WAV.EL_CountDarkAreas length=8 format=11. AS EL_CountDarkAreas,
        WAFER_WAV.EL_CountFingers length=8 format=11. AS EL_CountFingers,
        WAFER_WAV.IR_AvgVoltage length=8 AS IR_AvgVoltage,
        WAFER_WAV.IR_AvgCurrent length=8 AS IR_AvgCurrent,
        WAFER_WAV.IR_EnergyInput length=8 AS IR_EnergyInput,
        WAFER_WAV.IR_EnergyValue length=8 AS IR_EnergyValue,
        WAFER_WAV.IR_MatShunt length=8 AS IR_MatShunt,
        WAFER_WAV.IR_NormShunt length=8 AS IR_NormShunt,
        WAFER_WAV.IR_QShunt length=8 AS IR_QShunt,
        WAFER_WAV.IR_AvgGray length=8 AS IR_AvgGray,
        WAFER_WAV.IR_MaxGray length=8 AS IR_MaxGray,
        WAFER_WAV.IR_MinGray length=8 AS IR_MinGray,
        WAFER_WAV.IR_StdDevGray length=8 AS IR_StdDevGray,
        WAFER_WAV.IR_VarGray length=8 AS IR_VarGray,
        WAFER_WAV.IR_DefectArea length=8 format=11. AS IR_DefectArea,
        WAFER_WAV.IR_MaxPtot length=8 AS IR_MaxPtot,
        WAFER_WAV.J0_Voc length=8 AS J0_Voc,
        WAFER_WAV.Ideal_FF length=8 AS Ideal_FF,
        WAFER_WAV.Rs_FF length=8 AS Rs_FF,
        WAFER_WAV.Rs_Dark_LightDark length=8 AS Rs_Dark_LightDark,
        WAFER_WAV.Rs_Light_LightDark length=8 AS Rs_Light_LightDark,
        WAFER_WAV.N_Light_Voc length=8 AS N_Light_Voc,
        WAFER_WAV.N_Light_Vmpp length=8 AS N_Light_Vmpp,
        WAFER_WAV.N_SunsVoc_Voc length=8 AS N_SunsVoc_Voc,
        WAFER_WAV.N_SunsVoc_Vmpp length=8 AS N_SunsVoc_Vmpp,
        WAFER_WAV.Fit_2diodes_SunsVoc length=8 format=11. AS Fit_2diodes_SunsVoc,
        WAFER_WAV.J01_2diodes_SunsVoc length=8 AS J01_2diodes_SunsVoc,
        WAFER_WAV.J02_2diodes_SunsVoc length=8 AS J02_2diodes_SunsVoc,
        WAFER_WAV.N1_2diodes_SunsVoc length=8 AS N1_2diodes_SunsVoc,
        WAFER_WAV.N2_2diodes_SunsVoc length=8 AS N2_2diodes_SunsVoc,
        WAFER_WAV.Rp_2diodes_SunsVoc length=8 AS Rp_2diodes_SunsVoc,
        WAFER_WAV.Grid_Front1 length=8 AS Grid_Front1,
        WAFER_WAV.Grid_Front2 length=8 AS Grid_Front2,
        WAFER_WAV.Grid_Front3 length=8 AS Grid_Front3,
        WAFER_WAV.Grid_Front4 length=8 AS Grid_Front4,
        WAFER_WAV.Grid_Front5 length=8 AS Grid_Front5,
        WAFER_WAV.Grid_Front6 length=8 AS Grid_Front6,
        WAFER_WAV.Grid_Front7 length=8 AS Grid_Front7,
        WAFER_WAV.Grid_Front8 length=8 AS Grid_Front8,
        WAFER_WAV.Grid_Rear1 length=8 AS Grid_Rear1,
        WAFER_WAV.Grid_Rear2 length=8 AS Grid_Rear2,
        WAFER_WAV.Grid_Rear3 length=8 AS Grid_Rear3,
        WAFER_WAV.Grid_Rear4 length=8 AS Grid_Rear4,
        WAFER_WAV.Grid_Rear5 length=8 AS Grid_Rear5,
        WAFER_WAV.Grid_Rear6 length=8 AS Grid_Rear6,
        WAFER_WAV.Grid_Rear7 length=8 AS Grid_Rear7,
        WAFER_WAV.Grid_Rear8 length=8 AS Grid_Rear8,
        WAFER_WAV.ErrorCode_TS length=8 format=11. AS ErrorCode_TS,
        WAFER_WAV.ErrorCode_LE length=8 format=11. AS ErrorCode_LE,
        WAFER_WAV.ErrorCode_IV length=8 format=11. AS ErrorCode_IV,
        WAFER_WAV.ErrorCode_IR length=8 format=11. AS ErrorCode_IR,
        WAFER_WAV.ErrorCode_EL length=8 format=11. AS ErrorCode_EL,
        WAFER_WAV.ErrorCode_CS length=8 format=11. AS ErrorCode_CS,
        WAFER_WAV.ErrorCode_AS length=8 format=11. AS ErrorCode_AS,
        WAFER_WAV.ErrorCode_PY length=8 format=11. AS ErrorCode_PY,
        WAFER_WAV.Temp_Cell length=8 AS Temp_Cell,
        WAFER_WAV.Temp_Pyrometer length=8 AS Temp_Pyrometer,
        WAFER_WAV.Temp_PyroAverage length=8 AS Temp_PyroAverage,
        WAFER_WAV.Temp_Spectro length=8 AS Temp_Spectro,
        WAFER_WAV.Temp_Chiller length=8 AS Temp_Chiller,
        WAFER_WAV.Intensity_25C length=8 AS Intensity_25C,
        WAFER_WAV.Irradiance_400_1100 length=8 AS Irradiance_400_1100,
        WAFER_WAV.Irradiance_300_1200 length=8 AS Irradiance_300_1200,
        WAFER_WAV.Range_300_400 length=8 AS Range_300_400,
        WAFER_WAV.Range_400_500 length=8 AS Range_400_500,
        WAFER_WAV.Range_500_600 length=8 AS Range_500_600,
        WAFER_WAV.Range_600_700 length=8 AS Range_600_700,
        WAFER_WAV.Range_700_800 length=8 AS Range_700_800,
        WAFER_WAV.Range_800_900 length=8 AS Range_800_900,
        WAFER_WAV.Range_900_1100 length=8 AS Range_900_1100,
        WAFER_WAV.Range_1100_1200 length=8 AS Range_1100_1200 
    FROM
        IN_LINE.WAFER_WAV WAFER_WAV 
    WHERE
        datepart(WAFER_WAV.TimeStamp_Flash) >= INTNX('day',date(),-90);
quit;
