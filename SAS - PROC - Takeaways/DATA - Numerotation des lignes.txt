PROC SQL;
CREATE TABLE WORK.CARTON
AS
SELECT Palette,CARTON,COUNT(idBrique) AS Nbr_Briques
FROM WORK.DTM_QUALITE_SUIVI_BRIQUES AS DTM
GROUP BY Palette,Carton;
RUN;

PROC SQL;
CREATE TABLE WORK.DTM_QUALITE
AS
SELECT NB.Nbr_Briques,DTM.*
	FROM WORK.DTM_QUALITE_SUIVI_BRIQUES AS DTM

		LEFT OUTER JOIN WORK.CARTON AS NB
		ON DTM.Carton = NB.Carton;
RUN;

PROC SORT
Data = WORK.DTM_QUALITE OUT = WORK.DTM_QUALITE_TRIES;
BY NumCommandePWT Palette Carton;
RUN;

DATA WORK.Stats;
SET WORK.DTM_QUALITE;
BY CARTON;
IF First.Carton THEN NumCarton = 0;
NumCarton + 1;
IF Nbr_Briques = 5 AND NumCarton >= 3 AND NumCarton <= 5 THEN Decompte_Brique =0;
ELSE Decompte_Brique = 1;
RUN;





